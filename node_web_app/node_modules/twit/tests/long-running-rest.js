var assert = require('assert'), 
	Twit = require('../lib/twitter'), 
	config = require('../config'), 
	util = require('util'),
	memwatch = require('memwatch')

var twit = new Twit(config)

console.log('running long-running node process on pid:', process.pid)

setInterval(function () {
	twit.get('search/tweets', { q: 'tolga' }, function (err, reply) {
		if (err) {
			console.log('err:', util.inspect(err, true, 10, true))
		}

		console.log('got reply. pid: %s. memoryUsage: %s', process.pid, util.inspect(process.memoryUsage(), true, 10, true))
	})
}, 90*1000)

memwatch.on('leak', function (info) {
	console.log('potential leak info:', util.inspect(info, true, 10, true))
})


